/home/jimmywu/homework/AI_capstone/Final_project/.venv/lib/python3.9/site-packages/albumentations/__init__.py:28: UserWarning: A new version of Albumentations is available: '2.0.8' (you have '2.0.6'). Upgrade using: pip install -U albumentations. To disable automatic update checks, set the environment variable NO_ALBUMENTATIONS_UPDATE to 1.
  check_for_updates()
/home/jimmywu/homework/AI_capstone/Final_project/.venv/lib/python3.9/site-packages/torch/cuda/__init__.py:174: UserWarning: CUDA initialization: The NVIDIA driver on your system is too old (found version 11040). Please update your GPU driver by downloading and installing a new version from the URL: http://www.nvidia.com/Download/index.aspx Alternatively, go to: https://pytorch.org to install a PyTorch version that has been compiled with your version of the CUDA driver. (Triggered internally at /pytorch/c10/cuda/CUDAFunctions.cpp:109.)
  return torch._C._cuda_getDeviceCount() > 0
Traceback (most recent call last):
  File "/home/jimmywu/homework/AI_capstone/Final_project/Artificial_Intelligence_Capstone_Final_Project/Segmentation/train.py", line 159, in <module>
    train(model, writer, device, train_loader, val_loader, args)
  File "/home/jimmywu/homework/AI_capstone/Final_project/Artificial_Intelligence_Capstone_Final_Project/Segmentation/train.py", line 105, in train
    running_loss = train_one_epoch(args.shot, model, optimizer, train_loader)
  File "/home/jimmywu/homework/AI_capstone/Final_project/Artificial_Intelligence_Capstone_Final_Project/Segmentation/train.py", line 66, in train_one_epoch
    outputs = model(support_imgs, support_masks, query_imgs)
  File "/home/jimmywu/homework/AI_capstone/Final_project/.venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/jimmywu/homework/AI_capstone/Final_project/.venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/jimmywu/homework/AI_capstone/Final_project/Artificial_Intelligence_Capstone_Final_Project/Segmentation/model.py", line 144, in forward
    support_feats = [self.encoder(support_imgs[i:i+1])[-1] for i in range(k)]
  File "/home/jimmywu/homework/AI_capstone/Final_project/Artificial_Intelligence_Capstone_Final_Project/Segmentation/model.py", line 144, in <listcomp>
    support_feats = [self.encoder(support_imgs[i:i+1])[-1] for i in range(k)]
  File "/home/jimmywu/homework/AI_capstone/Final_project/.venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/jimmywu/homework/AI_capstone/Final_project/.venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/jimmywu/homework/AI_capstone/Final_project/.venv/lib/python3.9/site-packages/segmentation_models_pytorch/encoders/resnet.py", line 65, in forward
    x = self.conv1(x)
  File "/home/jimmywu/homework/AI_capstone/Final_project/.venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/jimmywu/homework/AI_capstone/Final_project/.venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/jimmywu/homework/AI_capstone/Final_project/.venv/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/jimmywu/homework/AI_capstone/Final_project/.venv/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
RuntimeError: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [1, 1, 3, 256, 256]
